<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="http://localhost:3000/workshop?name=css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <title>Notation Workshop</title>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script type="text/javascript" src="http://localhost:3000/workshop?name=display"></script>
  </head>
  <body id="body">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
          <a class="nav-item nav-link" href="http://localhost:3000/workshop?name=notation">SÃ©lectionner</a>
          <a class="nav-item nav-link" href="http://localhost:3000/workshop?name=seeRank">Voir</a>
        </div>
      </div>
    </nav>
    <div class="container">
      <h3 class="text-center my-4">Classement</h3>
      <div  id="division">
          <script type="text/javascript">
          var xhttp = new XMLHttpRequest()
        	var data = null


        	xhttp.onreadystatechange = function() {
        		if (this.readyState == 4 && this.status == 200) {
        			data = JSON.parse(this.responseText)

        			var ranking = []
        			for (var i = 0 ; i < data.notation[0].grade.length ; i++) {
        				ranking[i] = []
        				ranking[i][1] = 0
        			}

        			for (var i = 0 ; i < data.notation.length ; i++) {
        				data.notation[i].grade.sort(equal)
        				for (var j = 0 ; j < data.notation[i].grade.length ; j++) {
        					data.notation[i].grade[j][1] = data.notation[i].grade[j].length + (j-1)
        				}
        			}

        			for (var i = 0 ; i < data.notation.length ; i++) {
        				for (var j = 0 ; j < data.notation[i].grade.length ; j++) {
        					if (data.notation[i].grade[j][0] == "Brest") {
        						ranking[0][0] = "Brest"
        						ranking[0][1] += data.notation[i].grade[j][1]
        					}
        					if (data.notation[i].grade[j][0] == "Bordeaux") {
        						ranking[1][0] = "Bordeaux"
        						ranking[1][1] += data.notation[i].grade[j][1]
        					}
        					if (data.notation[i].grade[j][0] == "Grenoble") {
        						ranking[2][0] = "Grenoble"
        						ranking[2][1] += data.notation[i].grade[j][1]
        					}
        					if (data.notation[i].grade[j][0] == "Arras") {
        						ranking[3][0] = "Arras"
        						ranking[3][1] += data.notation[i].grade[j][1]
        					}
        					if (data.notation[i].grade[j][0] == "Lille") {
        						ranking[4][0] = "Lille"
        						ranking[4][1] += data.notation[i].grade[j][1]
        					}
        					if (data.notation[i].grade[j][0] == "Lyon") {
        						ranking[5][0] = "Lyon"
        						ranking[5][1] += data.notation[i].grade[j][1]
        					}
        					if (data.notation[i].grade[j][0] == "Montpellier") {
        						ranking[6][0] = "Montpellier"
        						ranking[6][1] += data.notation[i].grade[j][1]
        					}
        					if (data.notation[i].grade[j][0] == "Paris") {
        						ranking[7][0] = "Paris"
        						ranking[7][1] += data.notation[i].grade[j][1]
        					}
        					if (data.notation[i].grade[j][0] == "Nantes") {
        						ranking[8][0] = "Nantes"
        						ranking[8][1] += data.notation[i].grade[j][1]
        					}
                  if (data.notation[i].grade[j][0] == "Sens") {
        						ranking[9][0] = "Sens"
        						ranking[9][1] += data.notation[i].grade[j][1]
        					}
        				}
        			}
              ranking.sort(equal)
              console.log(ranking)
              for (var i = ranking.length -1; i>=0; i--)
              {
                displayRanking(ranking,i)
              }
            }
          }
          xhttp.open("GET", "/workshop?name=stockage", true)
          xhttp.send()

          function equal(a,b) {
              if (parseInt(a[1]) < parseInt(b[1])) return -1
              if (parseInt(a[1]) > parseInt(b[1])) return 1
              return 0
          }

          </script>
      </div>
    </div>
  </body>
</html>
